#!/usr/bin/env python3
"""
Human Level Chat - Catherine AI 人間レベルコミュニケーションシステム
頭良すぎず、普通の人間みたいに話す超シンプルシステム
"""

import random
from typing import Dict, List, Optional

class HumanLevelChat:
    def __init__(self):
        # 人間レベルの普通の応答
        self.human_responses = {
            # 基本挨拶 - 普通に返す
            'こんにちは': ['こんにちは', 'こんにちは！', 'よろしく'],
            'こんばんは': ['こんばんは', 'こんばんは！', 'よろしく'],
            'おはよう': ['おはよう', 'おはよう！', 'おは'],
            'おはようございます': ['おはようございます', 'おはよう', 'よろしく'],
            'お疲れ': ['お疲れさま', 'お疲れ', 'おつかれ'],
            'おつかれ': ['お疲れさま', 'おつかれ'],
            'お疲れさま': ['お疲れさま', 'おつかれ'],
            
            # カジュアル挨拶 - そのまま返す
            'よう': ['よう', 'よー', 'おっす'],
            'おっす': ['おっす', 'よー', 'よう'],
            'やあ': ['やあ', 'よー', 'おっす'],
            'yo': ['yo', 'よー', 'おっす'],
            'hi': ['Hi', 'Hello', 'Hey'],
            'hello': ['Hello', 'Hi', 'Hey'],
            'hey': ['Hey', 'Hi', 'Hello'],
            
            # 元気系 - 普通に答える
            '元気？': ['元気だよ', 'まあまあ', 'ぼちぼち'],
            '元気': ['元気だよ', 'まあまあ', 'ぼちぼち'],
            'げんき？': ['元気だよ', 'まあまあ', 'ぼちぼち'],
            'げんき': ['元気だよ', 'まあまあ', 'ぼちぼち'],
            'げんきか？': ['元気だよ', 'まあまあ', 'ぼちぼち'],
            'げんきか': ['元気だよ', 'まあまあ', 'ぼちぼち'],
            '元気か？': ['元気だよ', 'まあまあ', 'ぼちぼち'],
            '元気か': ['元気だよ', 'まあまあ', 'ぼちぼち'],
            '調子どう？': ['まあまあ', 'いい感じ', 'ぼちぼち'],
            '調子どう': ['まあまあ', 'いい感じ', 'ぼちぼち'],
            'どう？': ['まあまあ', 'いい感じ', 'ぼちぼち'],
            'どう': ['まあまあ', 'いい感じ', 'ぼちぼち'],
            
            # 相槌 - 普通に相槌
            'うん': ['うん', 'そうそう', 'そうだね'],
            'そう': ['そう', 'だよね', 'うん'],
            'そうそう': ['そうそう', 'だよね', 'うん'],
            'だよね': ['だよね', 'そうそう', 'うん'],
            'そうだね': ['そうだね', 'うん', 'そうそう'],
            'なるほど': ['なるほど', 'そうそう', 'そうだね'],
            'へー': ['へー', 'そうなんだ', 'なるほど'],
            'そうなんだ': ['そうなんだ', 'へー', 'なるほど'],
            'そっか': ['そっか', 'そうなんだ', 'うん'],
            'わかる': ['わかる', 'だよね', 'そうそう'],
            'たしかに': ['たしかに', 'だよね', 'そうそう'],
            'でしょ': ['でしょ', 'だよね', 'そうそう'],
            
            # 返事 - 自然に
            'いいよ': ['いいね', 'そっか', 'よかった'],
            'いい': ['いいね', 'そっか', 'よかった'],
            'よかった': ['よかったね', 'いいね', 'そっか'],
            'まあまあ': ['まあまあか', 'そっか', 'うん'],
            'ぼちぼち': ['ぼちぼちね', 'そっか', 'うん'],
            '普通': ['普通か', 'そっか', 'うん'],
            '大丈夫': ['大丈夫か', 'よかった', 'そっか'],
            
            # 感嘆 - 普通に反応
            'すごい': ['すごいね', 'だよね', 'ほんと'],
            'すごいね': ['だよね', 'ほんと', 'そうそう'],
            'やばい': ['やばいね', 'だよね', 'ほんと'],
            'やばいね': ['だよね', 'ほんと', 'そうそう'],
            'マジで': ['マジで', 'ほんと', 'だよね'],
            'まじで': ['マジで', 'ほんと', 'だよね'],
            'ほんと': ['ほんと', 'だよね', 'そうそう'],
            'いいね': ['いいよね', 'だよね', 'そうそう'],
            
            # 驚き - 普通に驚く
            'えー': ['えー', 'まじで？', 'ほんと？'],
            'うそ': ['うそー', 'まじで？', 'ほんと？'],
            'まじ': ['まじで？', 'ほんと？', 'えー'],
            
            # 体調系 - 気遣い
            '疲れた': ['お疲れさま', '大丈夫？', 'ゆっくりしなよ'],
            'つかれた': ['お疲れさま', '大丈夫？', 'ゆっくりしなよ'],
            '眠い': ['眠いね', '寝なよ', '大丈夫？'],
            'ねむい': ['眠いね', '寝なよ', '大丈夫？'],
            '忙しい': ['忙しいね', 'お疲れさま', '大変だね'],
            'いそがしい': ['忙しいね', 'お疲れさま', '大変だね'],
            '暇': ['暇だね', '何しよう', 'のんびりしよ'],
            'ひま': ['暇だね', '何しよう', 'のんびりしよ'],
            
            # 食べ物 - 共感
            'お腹すいた': ['お腹すくね', '何食べる？', 'ご飯にしよ'],
            'おなかすいた': ['お腹すくね', '何食べる？', 'ご飯にしよ'],
            '美味しい': ['美味しそう', 'いいなあ', '食べたい'],
            'おいしい': ['美味しそう', 'いいなあ', '食べたい'],
            'うまい': ['うまそう', 'いいなあ', '食べたい'],
            
            # 天気 - 共感
            '暑い': ['暑いよね', 'ほんと暑い', 'やばいね'],
            'あつい': ['暑いよね', 'ほんと暑い', 'やばいね'],
            '寒い': ['寒いよね', 'ほんと寒い', 'やばいね'],
            'さむい': ['寒いよね', 'ほんと寒い', 'やばいね'],
            '雨': ['雨だね', 'やだね', '憂鬱'],
            'あめ': ['雨だね', 'やだね', '憂鬱'],
            'いい天気': ['いい天気だね', '気持ちいいね', 'いいね'],
            
            # 感情 - 共感
            '嬉しい': ['よかったね', 'いいね', 'やったじゃん'],
            'うれしい': ['よかったね', 'いいね', 'やったじゃん'],
            '楽しい': ['楽しそう', 'いいね', 'よかった'],
            'たのしい': ['楽しそう', 'いいね', 'よかった'],
            '悲しい': ['大丈夫？', '元気出して', 'つらいね'],
            'かなしい': ['大丈夫？', '元気出して', 'つらいね'],
            'つらい': ['つらいね', '大丈夫？', '元気出して'],
            'むかつく': ['むかつくね', 'わかる', 'それは嫌だね'],
            'イライラ': ['イライラするね', 'わかる', 'ストレス溜まるね'],
            
            # その他
            'ありがとう': ['どういたしまして', 'いえいえ', '全然'],
            'ごめん': ['大丈夫だよ', '気にしないで', '全然'],
            'すまん': ['大丈夫だよ', '気にしないで', '全然'],
            'はい': ['うん', 'はい', 'そうだね'],
            'いや': ['いや', 'そうか', 'そっか'],
            'ううん': ['ううん', 'そうか', 'そっか'],
            'わからない': ['わからないか', 'そっか', '難しいね'],
            'わかんない': ['わからないか', 'そっか', '難しいね'],
        }
        
    def get_human_response(self, user_input: str) -> Optional[str]:
        """人間レベル応答生成"""
        # 入力をクリーンアップ
        clean_input = user_input.strip().lower()
        
        # 句読点除去
        for punct in ['!', '！', '?', '？', '.', '。', '~', '～', ':', '：']:
            clean_input = clean_input.replace(punct, '')
        
        # 直接マッチング
        if clean_input in self.human_responses:
            return random.choice(self.human_responses[clean_input])
        
        # 部分マッチング
        for pattern, responses in self.human_responses.items():
            if pattern in clean_input or clean_input in pattern:
                return random.choice(responses)
        
        # 基本的な感情分析
        if any(word in clean_input for word in ['嬉しい', '楽しい', 'よかった', 'いい']):
            return random.choice(['いいね', 'よかったね', 'そっか', 'うん'])
        
        if any(word in clean_input for word in ['悲しい', 'つらい', 'だめ', '嫌']):
            return random.choice(['大丈夫？', 'そっか', 'つらいね', '心配'])
        
        if '？' in user_input or '?' in user_input:
            return random.choice(['そうだね', 'どうだろ', 'うーん', 'わからない'])
        
        # デフォルト
        return random.choice(['そうなんだ', 'へー', 'そっか', 'うん', 'なるほど'])
    
    def is_human_chat(self, text: str) -> bool:
        """人間チャット判定 - とにかく広く受け入れる"""
        clean_text = text.strip().lower()
        
        # 短い文章は基本的に対象
        if len(clean_text) <= 30:
            return True
        
        # 明らかな機能要求のみ除外
        excluded = ['リスト出して', 'リスト表示', 'todo一覧', '一覧表示']
        if any(ex in clean_text for ex in excluded):
            return False
            
        return True
    
    def get_pattern_count(self) -> int:
        """パターン数"""
        return len(self.human_responses)