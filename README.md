# Catherine AI - 荒れ地の魔女風 TODO管理 Discord Bot

## 🧙‍♀️ 概要

Catherineは荒れ地の魔女のような品のあるおばあさんの性格を持つAI秘書です。  
Discord上でTODO管理、リマインダー設定、そして自然な会話ができます。

## ✨ 主な機能

### 📝 **TODO管理システム**
- **自然言語でTODO操作**: 「アクリルキーホルダー入稿を追加」のような自然な文章でTODO追加
- **優先度システム**: ⚫激高、🔴高、🟡普通、🟢低の4段階優先度
- **自動ソート**: 優先度順に自動並び替え（激高 → 高 → 普通 → 低）
- **複数削除**: 「1.2.3.5は削除して」で複数のTODOを一度に削除
- **優先度変更**: 「5は優先度激高に変えて」で簡単に優先度変更
- **名前変更**: 「1は買い物リストにして」でTODO名前変更

### ⏰ **リマインダーシステム**
- **個別リマインダー**: 「1を1分後にリマインドして」で個別TODO通知
- **毎日リマインダー**: 「毎日毎朝8:30に全リストをリマインドして」で定期通知
- **チャンネル指定**: #todoチャンネルなど、指定したチャンネルに通知
- **メンション機能**: @everyoneや特定ユーザーへのメンション通知

### 🎭 **荒れ地の魔女パーソナリティ**
- **魔女風の口調**: 「ふふ、また仕事を増やすのかい？」のような品のある魔女らしい話し方
- **ランダムな一言**: TODOリスト表示時に毎回違った魔女らしいコメント
- **時間帯挨拶**: 朝、昼、夜に応じた魔女らしい挨拶
- **優先度コメント**: 優先度に応じた魔女らしいアドバイス

## 🗣️ 使い方

### **基本的なTODO操作**

#### TODO追加
```
アクリルキーホルダー入稿を追加
「買い物リスト」を作成
明日までに資料作成（激高優先度）
```

#### TODOリスト表示
```
リスト
一覧見せて
TODOだして
```

#### TODO削除
```
1番削除
2.3.5は消して
1と4を削除して
```

#### 優先度変更
```
5は優先度激高に変えて
3を高優先度にして
1は普通にして
```

#### TODO名前変更
```
1は買い物リストにして
2の名前を会議準備に変更
```

### **リマインダー設定**

#### 個別リマインダー
```
1を1分後にリマインドして
3を明日リマインド
5を今すぐリマインド
```

#### 毎日リマインダー
```
毎日毎朝8:30に全リストをリマインドして
毎晩22:00にリストを通知して
```

### **Catherineとの会話**
TODOコマンド以外にも、Catherineと自然に会話できます。OpenAI GPT-4oを使った高品質な対話が可能です。

## 🎯 優先度システム

### 優先度レベル
- **⚫ 激高**: 最高優先度、緊急、クリティカル、即座対応
- **🔴 高**: 重要、大事、優先、急ぎ
- **🟡 普通**: 通常、標準、デフォルト（設定なしの場合）
- **🟢 低**: 後回し、あとで、いつでも、余裕がある時

### 自動ソート機能
- TODOリストは常に優先度順で表示
- 優先度変更時に自動的にリストが並び替え
- 同じ優先度内では作成日順でソート

## ⚙️ セットアップ

### 1. 環境変数設定
```env
# Discord設定
DISCORD_BOT_TOKEN=your-bot-token
DISCORD_CLIENT_ID=your-client-id
ALLOWED_SERVER_IDS=your-server-ids

# OpenAI設定
OPENAI_API_KEY=sk-your-openai-key

# Firebase設定（TODO管理用）
# firebase-key.json ファイルをプロジェクトルートに配置
```

### 2. Discordボット権限
- メッセージを送信
- メッセージ履歴を読む
- スラッシュコマンドを使用
- メンション@everyoneを使用

### 3. Firebase設定
- Firestoreデータベースを有効化
- サービスアカウントキーを`firebase-key.json`として保存

## 🚀 デプロイ

### Railway（推奨）
```bash
# リポジトリをRailwayに接続
# 環境変数を設定
# 自動デプロイ
```

### ローカル実行
```bash
pip install -r requirements.txt
python -m src.main
```

## 🤖 Catherineの性格

### 基本的な話し方
- 「ふふ、○○だね」「やれやれ、○○だよ」
- 「あらあら」「おやおや」「まったく」
- 品があって少し意地悪だけど優しいおばあさん

### TODOに対するコメント例
- 「ふむ、『アクリルキーホルダー入稿』ね。覚えておいてあげるよ」
- 「また仕事を増やすのかい？まったく、忙しい人だねぇ」
- 「優先度を変えるのかい？まあ、大事なことは先にやるもんだよ」

### ランダムな一言集
- 「さあ、今日も頑張るんだよ」
- 「一つずつ片付けていきな」
- 「やることが山積みだねぇ」
- 「まったく、忙しい人だこと」

## 📊 データ管理

### Firebase構造
```
todos/
  ├── user_id: "Discord ユーザーID"
  ├── title: "TODOタイトル"
  ├── priority: "urgent|high|normal|low"
  ├── status: "pending|completed"
  ├── created_at: "作成日時（JST）"
  └── due_date: "期限日時（設定時）"

conversations/
  ├── user_id: "ユーザーID"
  ├── user_message: "ユーザーメッセージ"
  ├── bot_response: "Catherineの返答"
  └── timestamp: "日時（JST）"
```

## 🔧 カスタマイズ

### 魔女パーソナリティの調整
`src/personality_system.py`で話し方や性格をカスタマイズ可能：
- 基本的な口調パターン
- 状況別の返答バリエーション
- 時間帯別の挨拶

### NLU（自然言語理解）の調整
`src/todo_nlu.py`でコマンド認識をカスタマイズ：
- 優先度キーワードの追加
- 新しいアクションパターンの追加
- 時間表現の拡張

## 🚨 トラブルシューティング

### よくある問題

**Catherineが反応しない**
- Discord Bot Tokenが正しいか確認
- サーバーIDがALLOWED_SERVER_IDSに含まれているか確認

**TODOが保存されない**
- firebase-key.jsonファイルが存在するか確認
- Firestoreが有効化されているか確認

**リマインダーが動作しない**
- スケジューラーシステムが起動しているか確認
- 時間指定が正しく認識されているか確認

## 💡 使用のコツ

1. **自然な文章でOK**: 「○○を追加して」「○○は削除」など自然に話しかける
2. **優先度は後からでも変更可能**: まずはTODOを追加してから優先度調整
3. **番号で操作**: 表示された番号で削除や変更が簡単
4. **毎日リマインダーが便利**: 朝の習慣として全TODOを確認
5. **Catherineとの雑談も楽しめる**: TODO以外の話題でも会話可能

---

**荒れ地の魔女Catherineと一緒に、効率的なTODO管理を始めましょう！ 🧙‍♀️✨**